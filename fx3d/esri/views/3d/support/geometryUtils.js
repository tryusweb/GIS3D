/**
 * Copyright @ 2017 Esri.
 * All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions.
 */
define(["esri/views/3d/layers/graphics/ElevationInfo","esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode","esri/views/3d/webgl-engine/lib/gl-matrix","esri/views/3d/webgl-engine/lib/Util"],function(e,r,a,i){var t=a.vec3d,o=a.mat4d,n=i.logWithBase,s=(new e,{mode:e.MODES.ON_THE_GROUND,offset:0},{mode:e.MODES.ABSOLUTE_HEIGHT,offset:0},1e4),l=10,v={getOrigin:function(e,a,i,v){if(!(e.length<=0)){var c=t.create();r.chooseOrigin(e,i,v,c),r.subtractCoordinates(e,0,a,c);for(var d,h=0,f=t.createFrom(e[h],e[h+1],e[h+2]),g=t.create(this.bbMin),m=0;a>m;m++){h=3*m;for(var u=0;3>u;u++)d=e[h+u],d<f[u]?f[u]=d:d>g[u]&&(g[u]=d)}var M=t.create();t.lerp(f,g,.5,M);for(var b=0,m=0;a>m;m++){h=3*m;var w=e[h]-M[0],O=e[h+1]-M[1],p=e[h+2]-M[2],E=w*w+O*O+p*p;E>b&&(b=E)}b=Math.sqrt(b);var _=o.identity();o.translate(_,c,_);var y=o.maxScale(_);o.multiplyVec3(_,M,M),b*=y;var S=l,D=0,C=b*S/s;C>1&&(D=Math.ceil(n(C,2)));var G=Math.pow(2,D)*s,m=Math.round(M[0]/G),H=Math.round(M[1]/G),u=Math.round(M[2]/G),T=D+"_"+m+"_"+H+"_"+u;return{vec3:t.createFrom(m*G,H*G,u*G),id:T}}}};return v});